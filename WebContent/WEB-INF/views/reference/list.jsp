<%@ page contentType="text/html; charset=UTF-8"%>
<%@ include file="../../common/taglib.jsp" %>

<section class="content">
	<div class="row page-titles">
		<div class="col-md-6 col-8 align-self-center">
			<h3 class="text-themecolor m-b-0 m-t-0"><spring:message code="referenceInfo" /></h3>
		</div>
	</div>
	
	
	<spring:message code='reward' var="reward"/>
	<div class="row el-element-overlay" id="guide_step1_tag">
		<h4 class="text-themecolor m-b-0 m-t-0">
			<span style="padding-left: 15px;">
				马来西亚 Malaysia
			</span>
		</h4>
		<!-- column -->
		<div class="col-12 m-t-5">
			<div class="card-deck">
				<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1" id="guide_step5_tag"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_19.PNG" alt="Universal-通用" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(19);"><i class="icon-docs"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">Universal<br/>通用</h4><br/>
		                </div>
		            </div>
			  	</div>
				<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_20.PNG" alt="马来西亚投资潜力" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(20);"><i class="icon-docs"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">马来西亚投资潜力</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_21.PNG" alt="马来西亚第二家园" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(21);"><i class="icon-docs"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">马来西亚第二家园</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_22.PNG" alt="销售流程,费用" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(22);"><i class="icon-docs"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">销售流程,费用</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_23.PNG" alt="参团照片-第2天  柔佛APC" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(23);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第2天  柔佛APC</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_24.PNG" alt="参团照片-第2天  柔佛APC介绍会" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(24);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第2天  柔佛APC介绍会</h4><br/>
		                </div>
		            </div>
			  	</div>
			</div>
		</div>
		<!-- column -->
		<div class="col-12 m-t-5">
			<div class="card-deck">
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_25.PNG" alt="参团照片-马六甲Haleton介绍会" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(25);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第2天 马六甲Haleton介绍会</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_26.PNG" alt="参团照片-马六甲Haleton产业" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(26);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第2天 马六甲Haleton产业</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_27.PNG" alt="参团照片-柔佛双威依斯干达" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(27);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第3天 柔佛双威依斯干达</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_29.PNG" alt="参团照片-Ritz-Carlton" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(29);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第3天 Ritz-Carlton</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_28.PNG" alt="参团照片-吉隆坡大马金豪" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(28);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">参团照片<br/>第4天 吉隆坡大马金豪</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			</div>
		</div>
	</div>
	<br />
	<div class="row el-element-overlay" id="guide_step2_tag">
		<h4 class="text-themecolor m-b-0 m-t-0">
			<span style="padding-left: 15px;">
				吉隆坡 Kuala Lumpur
			</span>
		</h4>
		<!-- column -->
		<div class="col-12 m-t-5">
			<div class="card-deck">
			  	<!-- Card -->
			  	<div class="card">
			  		<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_15.PNG" alt="Famous school-知名学校" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a id="guide_href1_tag" class="btn default btn-outline" href="javascript:btnFileClicked(15);"><i class="icon-docs"></i></a></li>
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(16);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">Famous school<br/>知名学校</h4><br/>
	                    </div>
	            	</div>
			  	</div>
			  	<!-- Card -->
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			</div>
		</div>
	</div>
	<br />
	<div class="row el-element-overlay" id="guide_step3_tag">
		<h4 class="text-themecolor m-b-0 m-t-0">
			<span style="padding-left: 15px;">
				新山 Johor
			</span>
		</h4>
		<!-- column -->
		<div class="col-12 m-t-5">
			<div class="card-deck">
				<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_17.PNG" alt="Regional-地區通用" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(17);"><i class="icon-picture"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">Regional<br/>地區通用</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			</div>
		</div>
	</div>
	<br />
	<div class="row el-element-overlay" id="guide_step4_tag">
		<h4 class="text-themecolor m-b-0 m-t-0">
			<span style="padding-left: 15px;">
				马六甲 Malacca
			</span>
		</h4>
		<!-- column -->
		<div class="col-12 m-t-5">
			<div class="card-deck">
				<!-- Card -->
				<div class="card">
				  	<div class="el-card-item">
		                <div class="el-card-avatar el-overlay-1"> <img src="${pageContext.request.contextPath}/resources/elastislide/images/pic/P_18.PNG" alt="Regional-地區通用" />
		                    <div class="el-overlay">
		                        <ul class="el-info">
		                            <li><a class="btn default btn-outline" href="javascript:btnFileClicked(18);"><i class="icon-docs"></i></a></li>
		                        </ul>
		                    </div>
		                </div>
		                <div class="el-card-content">
		                    <h4 class="box-title">Regional<br/>地區通用</h4><br/>
		                </div>
		            </div>
			  	</div>
			  	<!-- Card -->
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			  	<div class="card" style="background: #f2f7f8">&nbsp;</div>
			</div>
		</div>
	</div>
	</section>

<!--.燈箱 File -->
<div class="modal fade bs-example-modal-lg" id="modal_File" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
		<div class="modal-header">
			<h4 class="modal-title"><spring:message code="file"/></h4>
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true" id="guide_step7_tag">×</button>
      	</div>
		<div class="modal_msg" style="display: none"></div>
      	<div class="modal-body">
            <form role="form" id="formFile" name="formFile">
				<input type="hidden" name="fileType" id="queryFileType" value="REFERENCE" />
				<input type="hidden" name="referenceId" id="referenceId" value="" />
				<div class="box box-primary">
					<div class="box-body no-padding">
						<table class="table table-striped" id="referenceFileMain" width="100%">
							<thead>
								<tr>
									<th>#</th>
									<th><spring:message code="fileName"/></th>
									<th><spring:message code="fileSize"/></th>
									<!-- 
									<th><spring:message code="downloadTimes"/></th>
									<th><spring:message code="fileDescription"/></th>
									<th><spring:message code="updatedTime"/></th>
									 -->
									<th style="width: 50px;"><spring:message code="option"/></th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			</form>
		</div>
	</div><!-- /.modal-content -->
  </div>
</div>
<!--/.燈箱 File -->

<script type="text/javascript">

	var referenceFileMain;

	Number.prototype.format = function(n, x) {
	    var re = '\\d(?=(\\d{' + (x || 3) + '})+' + (n > 0 ? '\\.' : '$') + ')';
	    return this.toFixed(Math.max(0, ~~n)).replace(new RegExp(re, 'g'), '$&,');
	};

	/*
	$.Elastislide.defaults = {
		// orientation 'horizontal' || 'vertical'
		orientation : 'horizontal',

		// sliding speed
		speed : 500,

		// sliding easing
		easing : 'ease-in-out',

		// the minimum number of items to show.
		// when we resize the window, this will make sure minItems are always shown
		// (unless of course minItems is higher than the total number of elements)
		minItems : 3,

		// index of the current item (left most item of the carousel)
		start : 0,

		// click item callback
		onClick : function( el, position, evt ) { return false; },
		onReady : function() { return false; },
		onBeforeSlide : function() { return false; },
		onAfterSlide : function() { return false; }
	};
	
	
	$( '#area_1' ).elastislide();
	$( '#area_2' ).elastislide();
	$( '#area_3' ).elastislide();
	$( '#area_4' ).elastislide();
	*/
	
	$(function() {
		referenceFileMain = $('#referenceFileMain').DataTable(
				{
					"bFilter" : false,
					"ordering" : false,
					"info" : false,
					"serverSide" : true,
					"bLengthChange" : false,
					"ajax" : {
						"url" : '${pageContext.request.contextPath}/reference/getReferenceFiles.json',
						"type" : 'POST',
						"data" : function(d) {
									d.referenceId = $('#referenceId').val(),
									d.isAdmin = false
								}
					},
					"columns" : [
						{ "data" : "dataSeq" },
						{ "data" : "fullFileName" },
						{ "data" : "fileSize", "render": function ( data, type, full, meta ) {
														      return data.format() + ' KB';
													    } }
						/*
						{ "data" : "downloadTimes" },
						{ "data" : "fileDescription" },
						{ "data" : "updateTime" }
						*/
					],
					"columnDefs" : [
						{
							"targets" : 0,
						    render: function (data, type, row, meta) {
						        return meta.row + meta.settings._iDisplayStart + 1;
						    }
						},
						{
							"targets" : 3,
							"data" : 'seqNo',
							"render" : function(data, type, row) {
								return '<div id="guide_step6_tag" style="width:20px"><a href="#">'
										+'<span class="icon-cloud-download" style="margin-right:10px" fileType="'+ row['fileType'] + '" seqNo="' + row['seqNo'] + '" onclick="btnDownloadClicked($(this));" title="<spring:message code="download"/>"></span></a>'
										+'</div>';
							}
						}
					],
					select: true
				});
	});

	//[File] 進入modal_File
	function btnFileClicked(referenceId) {
		$('#referenceId').val(referenceId);

		//if (referenceFileMain) {
		//	$('#referenceFileMain').DataTable().destroy();
		//}

		referenceFileMain.ajax.reload();	//重查資料

		$('#modal_File').modal();
		
		if (showGuide == 'Y') {
			setTimeout(function() {
				showGuideTour();
			}, 500);
		}
	}
	
	//[Download] 按下Download按鈕
	function btnDownloadClicked(btn) {
		var downloadUrl = "${pageContext.request.contextPath}/manage/referenceFile/download?seqNo="+btn.attr('seqNo')+"&fileType="+btn.attr('fileType')+"&fromPage=reference/list";
	  	window.location.href = downloadUrl;

	  	setTimeout(function(){
	  		if (referenceFileMain) {
	  			referenceFileMain.ajax.reload();
	  		}
	  	}, 2000);
	}
</script>

	<script>
	    var showGuide = '${showGuide}';
	    var isHome = '${active}';
	    var title_reference = '<spring:message code="guide_tour_msg_51"/>'; //『参考信息』导览说明
	    $(document).ready(function(){
	    //function showGuideTour() {
	      if("Y"===showGuide) {
			//showTip();
	    	// Instance the tour
			var tour = new Tour({
				backdrop: true,
				smartPlacement: true,
				storage: false,
				template: 
					function (key, value) { 
						return getGuideTourTemplate(true);
					}
				,
				steps: [
	    	  		{
	    	    		element: "#guide_step1_tag",
	    	    		title: title_reference + " - 1/8",
	    	    		content: '<spring:message code="guide_tour_msg_52"/>', //依地區分別呈顯產品列表 >> 马来西亚
	    	    		placement: "top",
	    	    		animation: false
	    	  		},
	    	  		{
	    	    		element: "#guide_step2_tag",
	    	    		title: title_reference + " - 2/8",
	    	    		content: '<spring:message code="guide_tour_msg_42"/>', //依地區分別呈顯產品列表 >> 吉隆坡
	    	    		placement: "top",
	    	    		animation: false
	    	    		
	    	  		},
	    	  		{
	    	    		element: "#guide_step3_tag",
	    	    		title: title_reference + " - 3/8",
	    	    		content: '<spring:message code="guide_tour_msg_43"/>', //依地區分別呈顯產品列表 >> 新山
	    	    		placement: "top",
	    	    		animation: false
	    	  		},
	    	  		{
	    	    		element: "#guide_step4_tag",
	    	    		title: title_reference + " - 4/8",
	    	    		content: '<spring:message code="guide_tour_msg_44"/>', //依地區分別呈顯產品列表 >> 马六甲
	    	    		placement: "top",
	    	    		animation: false
	    	  		},
	    	  		{
	    	    		element: "#guide_step5_tag",
	    	    		title: title_reference + " - 5/8",
	    	    		content: '<spring:message code="guide_tour_msg_46"/>', //滑鼠移至产品图上呈显档案下载图示;点击图示进入档案下载画面
	    	    		placement: "bottom",
	    	    		animation: false,
	    	    		onHidden: function() {
	    	    			btnFileClicked(19);
	    	    	    },
	    	    		onShown: function() {
	    	    			$('.btn[data-role="next"]').removeClass("disabled");
	    	    			$('.btn[data-role="next"]').prop("disabled", false);
	    	    			$('.btn[data-role="next"]').on("click", function (e) {
	    	                    tour.end();
	    	                });
	    	    		}
	    	  		}
	    		]});
	
	    	// Initialize the tour
	    	tour.init();
	
	    	// Start the tour
	    	tour.start();
	    	//tour.restart();
	      }
	    });
	    //}
	    
	    function showGuideTour() {
	      if("Y"===showGuide) {
			//showTip();
	    	// Instance the tour
			var tour = new Tour({
				backdrop: true,
				smartPlacement: true,
				storage: false,
				template: 
					function (key, value) { 
						var isNotLastStep = false;
						if (key != 3) {
							isNotLastStep = true
						}
						return getGuideTourTemplate(isNotLastStep);
					}
				,
				steps: [
	    	  		{
	    	    		element: "#referenceFileMain",
	    	    		title: title_reference + " - 6/8",
	    	    		content: '<spring:message code="guide_tour_msg_53"/>', //检视提供下载的档案资料
	    	    		placement: "top",
	    	    		animation: false
	    	  		},
	    	  		{
	    	    		element: "#guide_step6_tag",
	    	    		title: title_reference + " - 7/8",
	    	    		content: '<spring:message code="guide_tour_msg_31"/>&nbsp;<span class="icon-cloud-download" style="margin-right:10px"></span><spring:message code="guide_tour_msg_101"/>', //点击云图示可下载档案
	    	    		placement: "bottom",
	    	    		animation: false
	    	    		
	    	  		},
	    	  		{
	    	    		element: "#guide_step7_tag",
	    	    		title: title_reference + " - 8/8",
	    	    		content: '<spring:message code="guide_tour_msg_49"/>', //点击X图示关闭画面
	    	    		placement: "bottom",
	    	    		animation: false,
	    	    		onHidden: function() {
	    	    			$('#guide_step7_tag').click();
	    	    		}
	    	  		},
	    	  		{
	    	    		element: "#visitInfo-tag",
	    	    		title: '<spring:message code="guide_tour_msg_54"/>', //『参团信息』导览说明
	    	    		content: '<spring:message code="guide_tour_msg_9"/>', //请点击功能选单进入下一阶段导览
	    	    		animation: false
	    	    		/*,
	    	    		onHidden: function() {
	    	    			$('#visitInfo-menu').get(0).click();
	    	    		}
	    	    		*/
	    	  		}
	    		]});
	
	    	// Initialize the tour
	    	tour.init();
	
	    	// Start the tour
	    	tour.start();
	    	//tour.restart();
	      }
	    }
	</script>